<?php
class Cassie{
	public $GLOBALS = array(
		'cluster' => null,
		'keyspace' => null,
		'session' => null,
		);

	public function connect(){

		$GLOBALS['cluster'] = Cassandra::cluster()
                                ->build();
		$GLOBALS['keyspace'] = 'drupal';
                $GLOBALS['session'] = $GLOBALS['cluster']->connect($GLOBALS['keyspace']);
		$GLOBALS['set']=Cassandra::values();
	}

	public function updateCounter($address){
		/**$cluster = Cassandra::cluster()
				->build();
		$keyspace = 'drupal';

		$session = $cluster->connect($keyspace);*/

		$statement = $GLOBALS['session']->execute(new Cassandra\SimpleStatement(
			"UPDATE popularity
			  SET counter = counter + 1
			  WHERE address = '$address'"
		));
	}

	public function getPants($page_id){
		$result = $GLOBALS['session']->execute(new Cassandra\SimpleStatement
			("SELECT products FROM products WHERE page_id = '$page_id'"));
		$array = $GLOBALS['set']->values($result);
		return $array;
	}
}
?>
